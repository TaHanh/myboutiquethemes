{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport Layout from '../../components/layout';\nimport { useState, useEffect, useRef } from 'react';\nimport Axios from 'axios';\nimport { ToastContainer, toast } from 'react-toastify';\nimport 'react-toastify/dist/ReactToastify.css';\nimport config from '../../config';\nimport '../../static/styles/composition.scss';\n\nfunction Composition(props) {\n  var [data, setData] = useState([]);\n  var [value, setValue] = useState('');\n  var [isLoad, setLoad] = useState(false);\n  useEffect(() => {\n    setData(props.compositions);\n  }, []);\n\n  var callBack = (key, value) => {\n    console.log(key, value);\n\n    switch (key) {\n      case 'POST_COMPOSITON':\n        if (value != '') {\n          setLoad(true);\n          Axios.post(config.host.base + config.path.base.compositions, {\n            name: value\n          }).then(res => {\n            var newArr = data.unshift(res.data);\n            setData(newArr);\n            console.log('POST_COMPOSITON', res);\n            toast.success('Success !', {\n              autoClose: 3000\n            });\n          }).catch(err => {\n            console.log('POST_COMPOSITON', err);\n            toast.error('Error !', {\n              autoClose: 3000\n            });\n          }).finally(fil => {\n            setLoad(false);\n          });\n        } else {\n          toast.error('Bạn chưa nhập thành phần !', {\n            autoClose: 3000\n          });\n        }\n\n        break;\n\n      case 'DELETE':\n        setLoad(true);\n        Axios.delete(config.host.base + config.path.base.compositions + value.item.id).then(res => {\n          data.splice(value.index, 1);\n          setData(data);\n          toast.success('Success !', {\n            autoClose: 3000\n          });\n        }).catch(err => {\n          console.log('POST_COMPOSITON', err);\n          toast.error('Error !', {\n            autoClose: 3000\n          });\n        }).finally(fil => {\n          setLoad(false);\n        });\n        break;\n\n      default:\n        break;\n    }\n  };\n\n  var changeInput = value => {\n    setValue(value.target.value);\n  };\n\n  return /*#__PURE__*/React.createElement(Layout, {\n    title: 'Thành phần'\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"composition px-md-4 px-3\"\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"py-md-5 pb-5\"\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row\"\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-12\"\n  }, /*#__PURE__*/React.createElement(\"h5\", null, \"Th\\xE0nh ph\\u1EA7n\"), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    className: \"form-control\",\n    multiple: true,\n    value: value,\n    onChange: e => {\n      changeInput(e);\n    },\n    onKeyPress: e => {\n      if (e.key == 'Enter') {\n        callBack('POST_COMPOSITON', value);\n      }\n    }\n  })))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row\"\n  }, props.compositions && props.compositions.map((item, index) => {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-lg-3 col-md-4 col-sm-6 col-12\"\n    }, /*#__PURE__*/React.createElement(\"li\", {\n      class: \"list-group-item d-flex justify-content-between align-items-center px-3 my-3\"\n    }, item.name, /*#__PURE__*/React.createElement(\"span\", {\n      class: \"badge badge-danger cursor-pointer ml-2\",\n      onClick: () => callBack('DELETE', {\n        item,\n        index\n      })\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      \"aria-hidden\": \"true\"\n    }, \"\\xD7\"))));\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row justify-content-center pt-5 mx-0\"\n  }, isLoad ? /*#__PURE__*/React.createElement(\"div\", {\n    class: \"spinner-border text-primary\",\n    role: \"status\"\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    class: \"sr-only\"\n  }, \"Loading...\")) : /*#__PURE__*/React.createElement(\"button\", {\n    type: \"button\",\n    class: \"btn btn-danger text-uppercase font-weight-bold\",\n    onClick: () => callBack('POST_COMPOSITON', value)\n  }, \"\\u0110\\u0103ng b\\xE0i\"))));\n}\n\nComposition.getInitialProps = /*#__PURE__*/_asyncToGenerator(function* () {\n  var compositions = [];\n  var resCompos = yield Axios.get(config.host.base + config.path.base.compositions).catch(e => console.log('Error: ', e.code));\n  compositions = resCompos && resCompos.data || [];\n  return {\n    compositions: compositions\n  };\n});\nexport default Composition;","map":null,"metadata":{},"sourceType":"module"}